/*!
 * chartjs-chart-treemap v0.2.3
 * https://github.com/kurkle/chartjs-chart-treemap#readme
 * (c) 2021 Jukka Kurkela
 * Released under the MIT license
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("chart.js")):"function"==typeof define&&define.amd?define(["chart.js"],e):e((t=t||self).Chart)}(this,function(t){"use strict";function e(t){var e=typeof t;return"function"===e||"object"===e&&!!t}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var n={flatten:function(t){const e=[...t],n=[];for(;e.length;){const t=e.pop();Array.isArray(t)?e.push(...t):n.push(t)}return n.reverse()},group:function(t,e,n,r,i){var o,a,s,l,h=Object.create(null),u=Object.create(null),f=[];for(a=0,s=t.length;a<s;++a)l=t[a],r&&l[r]!==i||((o=l[e]||"")in h||(h[o]=0,u[o]=[]),h[o]+=+l[n],u[o].push(l));return Object.keys(h).forEach(function(t){(l={children:u[t]})[n]=+h[t],l[e]=t,r&&(l[r]=i),f.push(l)}),f},index:function(t,n){var r,i,o=t.length;if(!o)return n;for(n=(i=e(t[0]))?n:"v",r=0,o=t.length;r<o;++r)i?t[r]._idx=r:t[r]={v:t[r],_idx:r};return n},isObject:e,sort:function(t,e){e?t.sort(function(t,n){return+n[e]-+t[e]}):t.sort(function(t,e){return+e-+t})},sum:function(t,e){var n,r,i;for(n=0,r=0,i=t.length;r<i;++r)n+=e?+t[r][e]:+t[r];return n}};function r(t,e){return+(Math.round(t+"e+"+e)+"e-"+e)}function i(t,e,n,r){var i=t._normalized,o=e*i/n,a=Math.sqrt(i*o),s=i/a;return{d1:a,d2:s,w:"_ix"===r?a:s,h:"_ix"===r?s:a}}function o(t,e,n,i){var o={x:r(t.x+t._ix,4),y:r(t.y+t._iy,4),w:r(n.w,4),h:r(n.h,4),a:e._normalized,v:e.value,s:i,_data:e._data};return e.group&&(o.g=e.group,o.l=e.level,o.gs=e.groupSum),o}class a{constructor(t){var e=this;e.x=t.x||t.left||0,e.y=t.y||t.top||0,e._ix=0,e._iy=0,e.w=t.w||t.width||t.right-t.left,e.h=t.h||t.height||t.bottom-t.top}get area(){return this.w*this.h}get iw(){return this.w-this._ix}get ih(){return this.h-this._iy}get dir(){var t=this.ih;return t<=this.iw&&t>0?"y":"x"}get side(){return"x"===this.dir?this.iw:this.ih}map(t){var e,n,r,a=this,s=[],l=t.nsum,h=t.get(),u=h.length,f=a.dir,d=a.side,g=d*d,c="x"===f?"_ix":"_iy",p=l*l,m=0,x=0;for(e=0;e<u;++e)x+=(r=i(n=h[e],g,p,c)).d1,r.d2>m&&(m=r.d2),s.push(o(a,n,r,t.sum)),a[c]+=r.d1;return a["y"===f?"_ix":"_iy"]+=m,a[c]-=x,s}}const s=Math.min,l=Math.max;function h(t,e){var n=+e[t.key],r=n*t.ratio;return e._normalized=r,{min:s(t.min,n),max:l(t.max,n),sum:t.sum+n,nmin:s(t.nmin,r),nmax:l(t.nmax,r),nsum:t.nsum+r}}function u(t,e,n){t._arr.push(e),function(t,e){Object.assign(t,e)}(t,n)}class f{constructor(t,e){this.key=t,this.ratio=e,this.reset()}get length(){return this._arr.length}reset(){var t=this;t._arr=[],t._hist=[],t.sum=0,t.nsum=0,t.min=1/0,t.max=-1/0,t.nmin=1/0,t.nmax=-1/0}push(t){u(this,t,h(this,t))}pushIf(t,e,...n){var r,i=h(this,t);if(!e((r=this,{min:r.min,max:r.max,sum:r.sum,nmin:r.nmin,nmax:r.nmax,nsum:r.nsum}),i,n))return t;u(this,t,i)}get(){return this._arr}}function d(t,e,n){if(0===t.sum)return!0;var[r]=n,i=t.nsum*t.nsum,o=e.nsum*e.nsum,a=r*r,s=Math.max(a*t.nmax/i,i/(a*t.nmin));return Math.max(a*e.nmax/o,o/(a*e.nmin))<=s}function g(t,e,r,i,o,s){var l,h,u,g,c=n.sum(t,r),p=[],m=new a(e),x=new f("value",m.area/c),y=m.side,v=t.length;if(!v)return p;function _(t){return i&&u[t][i]}for(u=t.slice(),r=n.index(u,r),n.sort(u,r),l=0;l<v;++l)h={value:(g=l,r?+u[g][r]:+u[g]),groupSum:s,_data:t[u[l]._idx]},i&&(h.level=o,h.group=_(l)),(h=x.pushIf(h,d,y))&&(p.push(m.map(x)),y=m.side,x.reset(),x.push(h));return x.length&&p.push(m.map(x)),n.flatten(p)}var c=t.defaults,p=t.helpers,m=p.options,x=m._parseFont,y=m.resolve,v=p.valueOrDefault;function _(t,e){var n=t.width||t.w,r=t.height||t.h,i=2*e.lineHeight;return n>i&&r>i}function b(t,e){const n=[""];return t.split(" ").forEach(t=>{n[n.length-1].length+t.length>e&&n.push(""),n[n.length-1]+=t+" "}),n.map(t=>t.trim()).filter(t=>t)}var w=t.DatasetController.extend({dataElementType:t.elements.Rectangle,update:function(t){var e,r,i,o,a,s,l=this,h=l.getMeta(),u=l.getDataset(),f=u.groups||(u.groups=[]),d=(e=u,p.extend(x({fontFamily:v(e.fontFamily,c.fontFamily),fontSize:v(e.fontSize,c.fontSize),fontStyle:v(e.fontStyle,c.fontStyle),lineHeight:v(e.lineHeight,c.lineHeight)}),{color:y([e.fontColor,c.fontColor,c.global.defaultFontColor])})),m=h.data||[],b=l.chart.chartArea,w=u.key||"";for(o={x:b.left,y:b.top,w:b.right-b.left,h:b.bottom-b.top},!t&&(a=l._rect,s=o,a&&s&&a.x===s.x&&a.y===s.y&&a.w===s.w&&a.h===s.h)&&l._key===w&&!function(t,e){var n,r;if(t.lenght!==e.length)return!0;for(n=0,r=t.length;n<r;++n)if(t[n]!==e[n])return!0;return!1}(l._groups,f)||(l._rect=o,l._groups=f.slice(),l._key=w,u.data=function(t,e,r){var i=t.key||"",o=t.tree||[],a=t.groups||[],s=a.length,l=(t.spacing||0)+(t.borderWidth||0);return!o.length&&t.data.length&&(o=t.tree=t.data),s?function t(e,h,u,f){var d,c=a[e],p=e>0&&a[e-1],m=g(n.group(o,c,i,p,u),h,i,c,e,f),x=m.slice();return e<s-1&&m.forEach(function(n){d={x:n.x+l,y:n.y+l,w:n.w-2*l,h:n.h-2*l},_(n,r)&&(d.y+=r.lineHeight,d.h-=r.lineHeight),x.push.apply(x,t(e+1,d,n.g,n.s))}),x}(0,e):g(o,e,i)}(u,o,d),l.resyncElements()),r=0,i=m.length;r<i;++r)l.updateElement(m[r],r,t)},updateElement:function(t,e,n){var r=this.index,i=this.getDataset().data[e],o=this._resolveElementOptions(t,e),a=n?0:i.h-2*o.spacing,s=n?0:i.w-2*o.spacing,l=i.x+s/2+o.spacing,h=i.y+a/2+o.spacing,u=a/2;t._options=o,t._datasetIndex=r,t._index=e,t.hidden=a<=o.spacing||s<=o.spacing,t._model={x:l,base:h-u,y:h+u,top:i.y,left:i.x,width:s,height:a,backgroundColor:o.backgroundColor,borderColor:o.borderColor,borderSkipped:o.borderSkipped,borderWidth:o.borderWidth,font:x(o),fontColor:o.fontColor},t.pivot()},draw:function(){var t,e,n,r,i,o=this.getMeta().data||[],a=this.getDataset(),s=(a.groups||[]).length-1,l=a.data||[],h=this.chart.ctx;for(t=0,e=o.length;t<e;++t)if(n=o[t],i=n._view,r=l[t],!n.hidden&&(n.draw(),_(i,i.font)&&r.g)){if(h.save(),h.fillStyle=i.fontColor,h.font=i.font.string,h.beginPath(),h.rect(i.left,i.top,i.width,i.height),h.clip(),"l"in r&&r.l!==s)h.textAlign="start",h.textBaseline="top",h.fillText(r.g,i.left+i.borderWidth+3,i.top+i.borderWidth+3);else if(h.textAlign="center",h.textBaseline="middle",r.g.length<i.width/6)h.fillText(r.g,i.left+i.width/2,i.top+i.height/2);else{let t=b(r.g,i.width/6),e=i.font.size,n=i.font.lineHeight,o=i.font.string,a=i.width/i.font.size;a<i.font.size&&a<5&&(i.font.size=1.75*Math.ceil(a),i.font.lineHeight=1.75*Math.ceil(a)*1.5,i.font.string=`${i.font.style} ${i.font.size}px ${i.font.family}`,h.font=i.font.string);let s=-(t.length/2-.5);t.forEach((t,e)=>{h.fillText(t,i.left+i.width/2,i.top+i.height/2+i.font.lineHeight*s),s++}),i.font.size=e,i.font.lineHeight=n,i.font.string=o}h.restore()}},_resolveElementOptions:function(t,e){var n,r,i,o=this.chart,a=this.getDataset(),s=o.options.elements.rectangle,l={},h={chart:o,dataIndex:e,dataset:a,datasetIndex:this.index},u=["backgroundColor","borderColor","borderSkipped","borderWidth","fontColor","fontFamily","fontSize","fontStyle","spacing"];for(n=0,r=u.length;n<r;++n)l[i=u[n]]=y([a[i],s[i]],h,e);return l}});t.controllers.treemap=w,t.defaults.treemap={hover:{mode:"point",intersect:!0},tooltips:{mode:"point",position:"treemap",intersect:!0,callbacks:{title:function(t,e){return e.datasets[t[0].datasetIndex].key},label:function(t,e){var n=e.datasets[t.datasetIndex],r=n.data[t.index];return n.label+": "+r.v}}},scales:{xAxes:[{type:"linear",display:!1}],yAxes:[{type:"linear",display:!1}]},elements:{rectangle:{borderSkipped:!1,borderWidth:0,spacing:.5}}},t.Tooltip.positioners.treemap=function(t){if(!t.length)return!1;var e=t[t.length-1]._view;return{x:e.x,y:e.y-e.height/2}}});
